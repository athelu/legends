<form class="{{cssClass}} flexcol" autocomplete="off">
  <header class="sheet-header">
    <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}" height="64" width="64"/>
    <div class="header-fields">
      <h1 class="charname"><input name="name" type="text" value="{{item.name}}" placeholder="Weapon Name"/></h1>
      
      <!-- Property Tags (dynamically shown based on checkboxes) -->
      <div class="weapon-tags">
        {{#each system.properties as |prop|}}
        <span class="tag property-tag">{{uppercase prop}}</span>
        {{/each}}
        
        {{#if system.damage.type}}
        <span class="tag damage-tag">{{uppercase system.damage.type}}</span>
        {{/if}}
        
        {{#if (gt system.range.normal 0)}}
        <span class="tag range-tag">RANGE {{system.range.normal}} FT.</span>
        {{/if}}
      </div>
    </div>
  </header>

  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="summary">Summary</a>
    <a class="item" data-tab="description">Description</a>
    <a class="item" data-tab="details">Details</a>
  </nav>

  <section class="sheet-body">
    
    <!-- SUMMARY Tab -->
    <div class="tab summary" data-group="primary" data-tab="summary">
      <div class="summary-grid">
        
        <!-- Quick Stats -->
        <div class="stat-block">
          <label>Damage</label>
          <div class="stat-value">{{system.damage.base}} {{system.damage.type}}</div>
        </div>
        
        <div class="stat-block">
          <label>Hands</label>
          <div class="stat-value">
            {{#if (contains system.properties "light")}}Light (1H)
            {{else if (contains system.properties "standard")}}Standard (1H)
            {{else if (contains system.properties "versatile")}}Versatile (1H/2H)
            {{else if (contains system.properties "two-handed")}}Two-Handed (2H)
            {{else}}1 Hand{{/if}}
          </div>
        </div>
        
        {{#if (gt system.range.normal 0)}}
        <div class="stat-block">
          <label>Range</label>
          <div class="stat-value">{{system.range.normal}} / {{system.range.medium}} / {{system.range.long}} ft</div>
        </div>
        {{/if}}
        
        <div class="stat-block">
          <label>Weight</label>
          <div class="stat-value">{{system.weight}} lbs</div>
        </div>
        
        <div class="stat-block">
          <label>Cost</label>
          <div class="stat-value">{{system.cost}} gp</div>
        </div>
        
        <div class="stat-block">
          <label>Quantity</label>
          <div class="stat-value">{{system.quantity}}</div>
        </div>
      </div>
      
      <!-- Active Properties -->
      <div class="properties-summary">
        <h3>Active Properties</h3>
        {{#if system.properties.length}}
        <ul class="properties-list">
          {{#each system.properties as |prop|}}
          <li><strong>{{capitalize prop}}:</strong> {{lookup ../propertyDescriptions prop}}</li>
          {{/each}}
        </ul>
        {{else}}
        <p class="hint"><em>No special properties</em></p>
        {{/if}}
      </div>
      
      <!-- Quick Description -->
      {{#if system.description.value}}
      <div class="quick-description">
        <h3>Description</h3>
        <div class="description-preview">
          {{{enrichedDescription}}}
        </div>
      </div>
      {{/if}}
    </div>

    <!-- DESCRIPTION Tab -->
    <div class="tab description" data-group="primary" data-tab="description">
      {{editor enrichedDescription target="system.description.value" button=true owner=owner editable=editable}}
    </div>

    <!-- DETAILS Tab -->
    <div class="tab details" data-group="primary" data-tab="details">
      
      <!-- Damage -->
      <div class="section-header">
        <h3>Damage</h3>
      </div>
      
      <div class="form-group-row">
        <div class="form-group">
          <label>Base Damage</label>
          <input type="number" name="system.damage.base" value="{{system.damage.base}}" data-dtype="Number" min="0" />
        </div>
        <div class="form-group">
          <label>Damage Type</label>
          <select name="system.damage.type">
            <option value="slashing" {{#if (eq system.damage.type "slashing")}}selected{{/if}}>Slashing</option>
            <option value="piercing" {{#if (eq system.damage.type "piercing")}}selected{{/if}}>Piercing</option>
            <option value="bludgeoning" {{#if (eq system.damage.type "bludgeoning")}}selected{{/if}}>Bludgeoning</option>
          </select>
        </div>
      </div>

      <div class="form-group-row">
        <div class="form-group">
          <label>Critical Damage Bonus</label>
          <input type="number" name="system.damage.critical" value="{{system.damage.critical}}" data-dtype="Number" min="0" placeholder="0" />
          <small>Additional damage on critical hits</small>
        </div>
      </div>

      <!-- Range (for ranged/thrown weapons) -->
      <div class="section-header">
        <h3>Range</h3>
      </div>
      
      <div class="form-group-row">
        <div class="form-group">
          <label>Normal Range</label>
          <input type="number" name="system.range.normal" value="{{system.range.normal}}" data-dtype="Number" min="0" placeholder="0" />
        </div>
        <div class="form-group">
          <label>Medium Range</label>
          <input type="number" name="system.range.medium" value="{{system.range.medium}}" data-dtype="Number" min="0" placeholder="0" />
        </div>
        <div class="form-group">
          <label>Long Range</label>
          <input type="number" name="system.range.long" value="{{system.range.long}}" data-dtype="Number" min="0" placeholder="0" />
        </div>
      </div>

      <!-- Properties -->
      <div class="section-header">
        <h3>Properties</h3>
      </div>
      
      <div class="properties-grid">
        <!-- Hand Usage Properties (Mutually Exclusive) -->
        <div class="property-category">
          <h4>Hand Usage (Choose One)</h4>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="light" {{#if (contains system.properties "light")}}checked{{/if}} />
            <span class="property-name">Light</span>
            <small>Can dual wield without penalty. Use d6 for attacks.</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="standard" {{#if (contains system.properties "standard")}}checked{{/if}} />
            <span class="property-name">Standard</span>
            <small>Normal one-handed weapon. Use d8 for attacks.</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="versatile" {{#if (contains system.properties "versatile")}}checked{{/if}} />
            <span class="property-name">Versatile</span>
            <small>Can use one or two hands. Use d8 (1H) or d10 (2H).</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="two-handed" {{#if (contains system.properties "two-handed")}}checked{{/if}} />
            <span class="property-name">Two-Handed</span>
            <small>Requires both hands. Use d10 for attacks.</small>
          </label>
        </div>

        <!-- Combat Properties -->
        <div class="property-category">
          <h4>Combat Properties</h4>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="finesse" {{#if (contains system.properties "finesse")}}checked{{/if}} />
            <span class="property-name">Finesse</span>
            <small>Use Agility instead of Strength for attack rolls.</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="reach" {{#if (contains system.properties "reach")}}checked{{/if}} />
            <span class="property-name">Reach</span>
            <small>Extends melee range by 5ft.</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="monk" {{#if (contains system.properties "monk")}}checked{{/if}} />
            <span class="property-name">Monk</span>
            <small>Usable with martial arts techniques.</small>
          </label>
        </div>

        <!-- Attack Type Properties -->
        <div class="property-category">
          <h4>Attack Types</h4>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="ranged" {{#if (contains system.properties "ranged")}}checked{{/if}} />
            <span class="property-name">Ranged</span>
            <small>Attacks at distance (requires range values).</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="thrown" {{#if (contains system.properties "thrown")}}checked{{/if}} />
            <span class="property-name">Thrown</span>
            <small>Can be thrown as ranged attack.</small>
          </label>
        </div>

        <!-- Special Properties -->
        <div class="property-category">
          <h4>Special Properties</h4>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="alternate-strike" {{#if (contains system.properties "alternate-strike")}}checked{{/if}} />
            <span class="property-name">Alternate Strike</span>
            <small>Can deal an alternate damage type (specify in notes).</small>
          </label>
          
          <label class="checkbox">
            <input type="checkbox" name="system.properties" value="multi-type" {{#if (contains system.properties "multi-type")}}checked{{/if}} />
            <span class="property-name">Multi-Type</span>
            <small>Deals multiple damage types simultaneously.</small>
          </label>
        </div>
      </div>

      <!-- Physical Properties -->
      <div class="section-header">
        <h3>Physical Properties</h3>
      </div>
      
      <div class="form-group-row">
        <div class="form-group">
          <label>Weight (lbs)</label>
          <input type="number" name="system.weight" value="{{system.weight}}" data-dtype="Number" step="0.1" min="0" />
        </div>
        <div class="form-group">
          <label>Cost (gp)</label>
          <input type="number" name="system.cost" value="{{system.cost}}" data-dtype="Number" min="0" />
        </div>
        <div class="form-group">
          <label>Quantity</label>
          <input type="number" name="system.quantity" value="{{system.quantity}}" data-dtype="Number" min="0" />
        </div>
      </div>

      <!-- Equipped Status -->
      <div class="form-group">
        <label class="checkbox">
          <input type="checkbox" name="system.equipped" {{#if system.equipped}}checked{{/if}} />
          <strong>Equipped</strong>
        </label>
      </div>

      <!-- Additional Notes -->
      <div class="section-header">
        <h3>Special Rules & Notes</h3>
      </div>
      
      <div class="form-group">
        <textarea name="system.notes" rows="4" placeholder="Any special rules or notes about this weapon">{{system.notes}}</textarea>
      </div>

    </div>
  </section>
</form>
